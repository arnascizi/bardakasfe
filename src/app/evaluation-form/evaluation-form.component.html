<div *ngIf="isSubmited" class="mt-3 text-success">
  Evaluation form was submitted.
</div>

<form
  *ngIf="evaluationForm"
  [formGroup]="evaluationForm"
  (submit)="submitForm()"
>
  <div class="my-3">
    <div
      [hidden]="
        evaluationForm.controls.studentId.valid ||
        evaluationForm.controls.studentId.pristine
      "
      class="text-danger"
    >
      <div *ngIf="evaluationForm.controls.studentId.errors?.required">
        Please select student.
      </div>
    </div>
    <label for="student" class="mr-2">Student:</label>
    <select
      class="custom-select col-7 border-primary border-3"
      formControlName="studentId"
      [ngClass]="{
        'is-invalid':
          evaluationForm.controls.studentId.invalid &&
          evaluationForm.controls.studentId.dirty
      }"
    >
      <option value="" disabled>Choose your option</option>
      <option *ngFor="let student of students$ | async" [ngValue]="student.id">
        {{ student.name }} {{ student.surname }}
      </option>
    </select>
  </div>

  <div class="form-group col-7">
    <label for="Teacher" class="mr-2"
      >Teacher: {{ teacher.name }} {{ teacher.surname }}</label
    >
    <div
      [hidden]="
        evaluationForm.controls.teacherComment.valid ||
        evaluationForm.controls.teacherComment.pristine
      "
      class="text-danger"
    >
      <div *ngIf="evaluationForm.controls.teacherComment.errors?.maxlength">
        Too many characters.
      </div>
    </div>
    <textarea
      class="form-control mb-4"
      id="teacherComment"
      type="text"
      formControlName="teacherComment"
      [ngClass]="{
        'is-invalid':
          evaluationForm.controls.teacherComment.invalid &&
          evaluationForm.controls.teacherComment.dirty
      }"
      rows="3"
    ></textarea>

    <div
      [hidden]="
        evaluationForm.controls.stream.valid ||
        evaluationForm.controls.stream.pristine
      "
      class="text-danger"
    >
      <div *ngIf="evaluationForm.controls.stream.errors?.required">
        Please select stream value.
      </div>
    </div>
    <label>Evaluation for :</label>
    <select
      class="custom-select mb-2 col-7 border-primary border-3"
      formControlName="stream"
      [ngClass]="{
        'is-invalid':
          evaluationForm.controls.stream.invalid &&
          evaluationForm.controls.stream.dirty
      }"
    >
      <option value="" disabled>Choose your option</option>
      <option *ngFor="let stream of allStreams" [ngValue]="stream">
        {{ stream }}
      </option>
    </select>

    <label for="communication" class="mt-3">Communication:</label>
    <div
      [hidden]="
        evaluationForm.controls.communication_Grade.valid ||
        evaluationForm.controls.communication_Grade.pristine
      "
      class="text-danger"
    >
      <div *ngIf="evaluationForm.controls.communication_Grade.errors?.required">
        Please select communication option.
      </div>
    </div>
    <select
      class="custom-select border-primary border-3"
      formControlName="communication_Grade"
      [ngClass]="{
        'is-invalid':
          evaluationForm.controls.communication_Grade.invalid &&
          evaluationForm.controls.communication_Grade.dirty
      }"
    >
      <option value="" disabled>Choose your option</option>
      <option
        *ngFor="let select of gradeSelectionOptions | keyvalue"
        [ngValue]="select.value"
      >
        {{ select.key }}
      </option>
    </select>

    <div
      [hidden]="
        evaluationForm.controls.communication_comments.valid ||
        evaluationForm.controls.communication_comments.pristine
      "
      class="text-danger"
    >
      <div
        *ngIf="evaluationForm.controls.communication_comments.errors?.maxlength"
      >
        Too many characters.
      </div>
    </div>
    <textarea
      class="form-control mt-2"
      type="text"
      formControlName="communication_comments"
      [ngClass]="{
        'is-invalid':
          evaluationForm.controls.communication_comments.invalid &&
          evaluationForm.controls.communication_comments.dirty
      }"
      rows="3"
    ></textarea>

    <label for="AbilityToLearn" class="mt-3">Ability to learn:</label>
    <div
      [hidden]="
        evaluationForm.controls.abilityToLearnSelect.valid ||
        evaluationForm.controls.abilityToLearnSelect.pristine
      "
      class="text-danger"
    >
      <div
        *ngIf="evaluationForm.controls.abilityToLearnSelect.errors?.required"
      >
        Please select ability to learn option.
      </div>
    </div>
    <select
      class="custom-select border-primary border-3"
      formControlName="abilityToLearnSelect"
      [ngClass]="{
        'is-invalid':
          evaluationForm.controls.abilityToLearnSelect.invalid &&
          evaluationForm.controls.abilityToLearnSelect.dirty
      }"
    >
      <option value="" disabled>Choose your option</option>
      <option
        *ngFor="let select of gradeSelectionOptions | keyvalue"
        [ngValue]="select.value"
      >
        {{ select.key }}
      </option>
    </select>
    <div
      [hidden]="
        evaluationForm.controls.abilityToLearnComment.valid ||
        evaluationForm.controls.abilityToLearnComment.pristine
      "
      class="text-danger"
    >
      <div
        *ngIf="evaluationForm.controls.abilityToLearnComment.errors?.maxlength"
      >
        Too many characters.
      </div>
    </div>
    <textarea
      class="form-control mt-2"
      id="abilityToLearnComment"
      type="text"
      formControlName="abilityToLearnComment"
      [ngClass]="{
        'is-invalid':
          evaluationForm.controls.abilityToLearnComment.invalid &&
          evaluationForm.controls.abilityToLearnComment.dirty
      }"
      rows="3"
    ></textarea>

    <label for="extraMile" class="mt-3">Extra mile:</label>
    <div
      [hidden]="
        evaluationForm.controls.is_extramile.valid ||
        evaluationForm.controls.is_extramile.pristine
      "
      class="text-danger"
    >
      <div *ngIf="evaluationForm.controls.is_extramile.errors?.required">
        Please select extra mile option.
      </div>
    </div>
    <select
      class="custom-select border-primary border-3"
      formControlName="is_extramile"
      [ngClass]="{
        'is-invalid':
          evaluationForm.controls.is_extramile.invalid &&
          evaluationForm.controls.is_extramile.dirty
      }"
    >
      <option value="" disabled>Choose your option</option>
      <option value="true">Yes</option>
      <option value="false">No</option>
    </select>
    <div
      [hidden]="
        evaluationForm.controls.is_extramile_comments.valid ||
        evaluationForm.controls.is_extramile_comments.pristine
      "
      class="text-danger"
    >
      <div
        *ngIf="evaluationForm.controls.is_extramile_comments.errors?.maxlength"
      >
        Too many characters.
      </div>
    </div>
    <textarea
      class="form-control mt-2"
      type="text"
      formControlName="is_extramile_comments"
      [ngClass]="{
        'is-invalid':
          evaluationForm.controls.is_extramile_comments.invalid &&
          evaluationForm.controls.is_extramile_comments.dirty
      }"
      rows="3"
    ></textarea>

    <label for="motivation" class="mt-3">Motivation:</label>
    <div
      [hidden]="
        evaluationForm.controls.is_motivated.valid ||
        evaluationForm.controls.is_motivated.pristine
      "
      class="text-danger"
    >
      <div *ngIf="evaluationForm.controls.is_motivated.errors?.required">
        Please select motivation option.
      </div>
    </div>
    <select
      class="custom-select border-primary border-3"
      formControlName="is_motivated"
      [ngClass]="{
        'is-invalid':
          evaluationForm.controls.is_motivated.invalid &&
          evaluationForm.controls.is_motivated.dirty
      }"
    >
      <option value="" disabled>Choose your option</option>
      <option value="true">Yes</option>
      <option value="false">No</option>
    </select>
    <div
      [hidden]="
        evaluationForm.controls.motivation_comments.valid ||
        evaluationForm.controls.motivation_comments.pristine
      "
      class="text-danger"
    >
      <div
        *ngIf="evaluationForm.controls.motivation_comments.errors?.maxlength"
      >
        Too many characters.
      </div>
    </div>
    <textarea
      class="form-control mt-2"
      type="text"
      formControlName="motivation_comments"
      [ngClass]="{
        'is-invalid':
          evaluationForm.controls.motivation_comments.invalid &&
          evaluationForm.controls.motivation_comments.dirty
      }"
      rows="3"
    ></textarea>

    <label for="direction" class="mt-3">Direction:</label>
    <div
      [hidden]="
        evaluationForm.controls.directionComment.valid ||
        evaluationForm.controls.directionComment.pristine
      "
      class="text-danger"
    >
      <div *ngIf="evaluationForm.controls.directionComment.errors?.required">
        Please fill up direction field.
      </div>
      <div *ngIf="evaluationForm.controls.directionComment.errors?.maxlength">
        Too many characters.
      </div>
    </div>
    <textarea
      class="form-control border-primary border-3"
      id="directionComment"
      type="text"
      formControlName="directionComment"
      [ngClass]="{
        'is-invalid':
          evaluationForm.controls.directionComment.invalid &&
          evaluationForm.controls.directionComment.dirty
      }"
      rows="3"
    ></textarea>

    <label for="overallEvaluation" class="mt-3 control-label"
      >Overall evaluation:</label
    >
    <div
      [hidden]="
        evaluationForm.controls.overallEvaluationSelect.valid ||
        evaluationForm.controls.overallEvaluationSelect.pristine
      "
      class="text-danger"
    >
      <div
        *ngIf="evaluationForm.controls.overallEvaluationSelect.errors?.required"
      >
        Please select extra mile option.
      </div>
    </div>
    <select
      class="custom-select border-primary border-3"
      formControlName="overallEvaluationSelect"
      [ngClass]="{
        'is-invalid':
          evaluationForm.controls.overallEvaluationSelect.invalid &&
          evaluationForm.controls.overallEvaluationSelect.dirty
      }"
    >
      <option value="" disabled>Choose your option</option>
      <option
        *ngFor="let select of overallEvaluationOptions | keyvalue"
        [ngValue]="select.value"
      >
        {{ select.key }}
      </option>
    </select>
    <div
      [hidden]="
        evaluationForm.controls.overall_comments.valid ||
        evaluationForm.controls.overall_comments.pristine
      "
      class="text-danger"
    >
      <div *ngIf="evaluationForm.controls.overall_comments.errors?.required">
        Please fill up direction field.
      </div>
      <div *ngIf="evaluationForm.controls.overall_comments.errors?.maxlength">
        Too many characters.
      </div>
    </div>
    <textarea
      class="form-control control-label mt-2 border-primary border-3"
      type="text"
      formControlName="overall_comments"
      [ngClass]="{
        'is-invalid':
          evaluationForm.controls.overall_comments.invalid &&
          evaluationForm.controls.overall_comments.dirty
      }"
      rows="4"
    ></textarea>
  </div>
  <div class="col-7" *ngIf="isEvaluationFormNew || teacher.id === loggedTeacher.id">
    <button
      class="btn btn-primary mr-3 float-right"
      type="submit"
      *ngIf="isEvaluationFormNew || isEditable"
    >
      Submit
    </button>
    <button
      class="btn btn-secondary float-right"
      *ngIf="!isEditable && !isEvaluationFormNew"
      (click)="makeEditable()"
    >
      Edit
    </button>
    <button
      class="btn btn-secondary float-right mr-2"
      *ngIf="isEditable"
      (click)="makeEditable()"
    >
      Cancel
    </button>
  </div>
</form>
